
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Jeu Nombres Thaï</title>
  <link rel="manifest" href="manifest.json" />
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js');
    }
  </script>
</head>
<body>
  <h1>Bienvenue sur l’application 🇹🇭</h1>
  <button onclick="startGame()">Commencer</button>

  <div id="game" style="display:none;">
    <p id="niveau"></p>
    <audio id="audio"></audio>
    <button onclick="playAudio()">🔊 Rejouer</button>
    <div id="choices"></div>
    <div id="feedback"></div>
  </div>

  <script>
    const thaiMap = {0:"ศูนย์",1:"หนึ่ง",2:"สอง",3:"สาม",4:"สี่",5:"ห้า",6:"หก",7:"เจ็ด",8:"แปด",9:"เก้า",10:"สิบ",20:"ยี่สิบ",30:"สามสิบ",40:"สี่สิบ",50:"ห้าสิบ",60:"หกสิบ",70:"เจ็ดสิบ",80:"แปดสิบ",100:"หนึ่งร้อย",105:"หนึ่งร้อยห้า",200:"สองร้อย",300:"สามร้อย",400:"สี่ร้อย",1000:"หนึ่งพัน",1500:"พันห้า",2000:"สองพัน",10000:"หนึ่งหมื่น"};
    const available = [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,40,50,60,70,80,100,105,200,300,400,1000,1500,2000,10000];
    let currentAnswer = null;
    let currentMaxIndex = 3;
    let currentRange = available.slice(0, currentMaxIndex + 1);
    let answered = new Set();
    let successStreak = 0;
    let attemptCount = 0;

    function startGame() {
      document.querySelector('button').style.display = 'none';
      document.getElementById('game').style.display = 'block';
      nextQuestion();
    }

    function playAudio() {
      const audio = document.getElementById("audio");
      audio.currentTime = 0;
      audio.play();
    }

    function updateUI() {
      document.getElementById("niveau").innerText = "Niveau : 0 à " + available[currentMaxIndex];
    }

    function nextQuestion() {
      if (answered.size >= currentRange.length) {
        successStreak++;
        answered.clear();
        attemptCount = 0;
        if (successStreak >= 3 && currentMaxIndex + 1 < available.length) {
          currentMaxIndex++;
          currentRange = available.slice(0, currentMaxIndex + 1);
          successStreak = 0;
        }
      }
      updateUI();
      const rand = Math.floor(Math.random() * currentRange.length);
      currentAnswer = currentRange[rand];
      const audio = document.getElementById("audio");
      audio.src = "audio/" + currentAnswer + ".mp3";
      audio.play();
      const options = new Set([currentAnswer]);
      while (options.size < 3) {
        const r = currentRange[Math.floor(Math.random() * currentRange.length)];
        options.add(r);
      }
      const choices = Array.from(options).sort(() => Math.random() - 0.5);
      const choiceDiv = document.getElementById("choices");
      choiceDiv.innerHTML = "";
      choices.forEach(n => {
        const btn = document.createElement("button");
        btn.textContent = `${n} = ${thaiMap[n] || ''}`;
        btn.onclick = () => checkAnswer(n);
        choiceDiv.appendChild(btn);
      });
    }

    function checkAnswer(choice) {
      const feedback = document.getElementById("feedback");
      attemptCount++;
      if (choice === currentAnswer) {
        feedback.textContent = "✅ Bonne réponse !";
        answered.add(choice);
        setTimeout(nextQuestion, 800);
      } else {
        feedback.textContent = "❌ Mauvaise réponse.";
        successStreak = 0;
        playAudio();
      }
    }
  </script>
</body>
</html>
