
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.5">
  <title>Jeu ultra lisible - Nombres en tha√Ø</title>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 40px; font-size: 40px; }
    button { margin: 10px; padding: 30px 50px; font-size: 40px; }
    .choices { margin-top: 40px; }
    .feedback { margin-top: 20px; font-weight: bold; font-size: 42px; }
    .bar-container {
      width: 90%; background: #eee; border-radius: 10px; margin: 20px auto;
    }
    .bar-fill {
      height: 30px; background: #4caf50; width: 0%; border-radius: 10px;
    }
  </style>
  <link rel="manifest" href="manifest.json">
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js');
    }
  </script>
  
</head>
<body>
  <h1>Jeu progressif des nombres en tha√Ø</h1>
  <p>√âcoutez le son et choisissez la bonne r√©ponse :</p>

  <div id="game">
    <p id="niveau">Niveau : 0 √† 3</p>
    <div class="bar-container">
      <div id="bar" class="bar-fill"></div>
    </div>
    <p>S√©ries r√©ussies sans erreur : <span id="success-streak">0</span> / 3</p>
    <p>Essais dans cette s√©rie : <span id="attempt-count">0</span></p>
    <audio id="audio"></audio>
    <button onclick="playAudio()">üîä Rejouer</button>
    <div class="choices" id="choices"></div>
    <div class="feedback" id="feedback"></div>
  </div>

  <script>
    const thaiMap = {
      0: "‡∏®‡∏π‡∏ô‡∏¢‡πå", 1: "‡∏´‡∏ô‡∏∂‡πà‡∏á", 2: "‡∏™‡∏≠‡∏á", 3: "‡∏™‡∏≤‡∏°", 4: "‡∏™‡∏µ‡πà", 5: "‡∏´‡πâ‡∏≤", 6: "‡∏´‡∏Å", 7: "‡πÄ‡∏à‡πá‡∏î", 8: "‡πÅ‡∏õ‡∏î", 9: "‡πÄ‡∏Å‡πâ‡∏≤",
      10: "‡∏™‡∏¥‡∏ö", 11: "‡∏™‡∏¥‡∏ö‡πÄ‡∏≠‡πá‡∏î", 12: "‡∏™‡∏¥‡∏ö‡∏™‡∏≠‡∏á", 13: "‡∏™‡∏¥‡∏ö‡∏™‡∏≤‡∏°", 14: "‡∏™‡∏¥‡∏ö‡∏™‡∏µ‡πà", 15: "‡∏™‡∏¥‡∏ö‡∏´‡πâ‡∏≤", 16: "‡∏™‡∏¥‡∏ö‡∏´‡∏Å",
      17: "‡∏™‡∏¥‡∏ö‡πÄ‡∏à‡πá‡∏î", 18: "‡∏™‡∏¥‡∏ö‡πÅ‡∏õ‡∏î", 19: "‡∏™‡∏¥‡∏ö‡πÄ‡∏Å‡πâ‡∏≤", 20: "‡∏¢‡∏µ‡πà‡∏™‡∏¥‡∏ö", 21: "‡∏¢‡∏µ‡πà‡∏™‡∏¥‡∏ö‡πÄ‡∏≠‡πá‡∏î", 22: "‡∏¢‡∏µ‡πà‡∏™‡∏¥‡∏ö‡∏™‡∏≠‡∏á",
      23: "‡∏¢‡∏µ‡πà‡∏™‡∏¥‡∏ö‡∏™‡∏≤‡∏°", 24: "‡∏¢‡∏µ‡πà‡∏™‡∏¥‡∏ö‡∏™‡∏µ‡πà", 25: "‡∏¢‡∏µ‡πà‡∏™‡∏¥‡∏ö‡∏´‡πâ‡∏≤", 26: "‡∏¢‡∏µ‡πà‡∏™‡∏¥‡∏ö‡∏´‡∏Å", 27: "‡∏¢‡∏µ‡πà‡∏™‡∏¥‡∏ö‡πÄ‡∏à‡πá‡∏î", 28: "‡∏¢‡∏µ‡πà‡∏™‡∏¥‡∏ö‡πÅ‡∏õ‡∏î",
      29: "‡∏¢‡∏µ‡πà‡∏™‡∏¥‡∏ö‡πÄ‡∏Å‡πâ‡∏≤", 30: "‡∏™‡∏≤‡∏°‡∏™‡∏¥‡∏ö", 31: "‡∏™‡∏≤‡∏°‡∏™‡∏¥‡∏ö‡πÄ‡∏≠‡πá‡∏î", 32: "‡∏™‡∏≤‡∏°‡∏™‡∏¥‡∏ö‡∏™‡∏≠‡∏á", 33: "‡∏™‡∏≤‡∏°‡∏™‡∏¥‡∏ö‡∏™‡∏≤‡∏°", 34: "‡∏™‡∏≤‡∏°‡∏™‡∏¥‡∏ö‡∏™‡∏µ‡πà",
      35: "‡∏™‡∏≤‡∏°‡∏™‡∏¥‡∏ö‡∏´‡πâ‡∏≤", 36: "‡∏™‡∏≤‡∏°‡∏™‡∏¥‡∏ö‡∏´‡∏Å", 40: "‡∏™‡∏µ‡πà‡∏™‡∏¥‡∏ö", 50: "‡∏´‡πâ‡∏≤‡∏™‡∏¥‡∏ö", 60: "‡∏´‡∏Å‡∏™‡∏¥‡∏ö", 70: "‡πÄ‡∏à‡πá‡∏î‡∏™‡∏¥‡∏ö",
      80: "‡πÅ‡∏õ‡∏î‡∏™‡∏¥‡∏ö", 100: "‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏£‡πâ‡∏≠‡∏¢", 105: "‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏£‡πâ‡∏≠‡∏¢‡∏´‡πâ‡∏≤", 200: "‡∏™‡∏≠‡∏á‡∏£‡πâ‡∏≠‡∏¢", 300: "‡∏™‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏¢",
      400: "‡∏™‡∏µ‡πà‡∏£‡πâ‡∏≠‡∏¢", 1000: "‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏û‡∏±‡∏ô", 1500: "‡∏û‡∏±‡∏ô‡∏´‡πâ‡∏≤", 2000: "‡∏™‡∏≠‡∏á‡∏û‡∏±‡∏ô", 10000: "‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏´‡∏°‡∏∑‡πà‡∏ô"
    };
    const availableNumbers = [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,
      25,26,27,28,29,30,31,32,33,34,35,36,40,50,60,70,80,100,105,200,300,400,1000,1500,2000,10000];

    let currentAnswer = null;
    let currentMaxIndex = 3;
    let currentRange = availableNumbers.slice(0, currentMaxIndex + 1);
    let answered = new Set();
    let successStreak = 0;
    let attemptCount = 0;

    function updateUI() {
      document.getElementById("niveau").innerText = "Niveau : 0 √† " + availableNumbers[currentMaxIndex];
      document.getElementById("success-streak").innerText = successStreak;
      document.getElementById("attempt-count").innerText = attemptCount;
      const percent = Math.floor(((currentMaxIndex + 1) / availableNumbers.length) * 100);
      document.getElementById("bar").style.width = percent + "%";
    }

    function playAudio() {
      const audio = document.getElementById('audio');
      audio.currentTime = 0;
      audio.play();
    }

    function nextQuestion() {
      document.getElementById('feedback').innerText = "";

      if (answered.size >= currentRange.length) {
        successStreak++;
        answered.clear();
        attemptCount = 0;

        if (successStreak >= 3 && currentMaxIndex + 1 < availableNumbers.length) {
          currentMaxIndex++;
          currentRange = availableNumbers.slice(0, currentMaxIndex + 1);
          successStreak = 0;
        }
      }

      updateUI();

      const randIndex = Math.floor(Math.random() * currentRange.length);
      currentAnswer = currentRange[randIndex];

      const choices = new Set();
      choices.add(currentAnswer);
      while (choices.size < 3) {
        const r = currentRange[Math.floor(Math.random() * currentRange.length)];
        choices.add(r);
      }

      const shuffled = Array.from(choices).sort(() => Math.random() - 0.5);

      const audio = document.getElementById('audio');
      audio.src = currentAnswer + ".mp3";
      audio.play();

      const choicesDiv = document.getElementById('choices');
      choicesDiv.innerHTML = "";
      shuffled.forEach(choice => {
        const btn = document.createElement('button');
        btn.innerText = choice + " = " + thaiMap[choice];
        btn.onclick = () => checkAnswer(choice);
        choicesDiv.appendChild(btn);
      });
    }

    function checkAnswer(choice) {
      const feedback = document.getElementById('feedback');
      attemptCount++;
      if (choice === currentAnswer) {
        feedback.innerText = "‚úÖ Bonne r√©ponse !";
        answered.add(choice);
        setTimeout(nextQuestion, 800);
      } else {
        feedback.innerText = "‚ùå Mauvaise r√©ponse. √âcoutez √† nouveau.";
        successStreak = 0;
        playAudio();
        updateUI();
      }
    }

    nextQuestion();
  </script>
</body>
</html>
